import{f as a}from"./fetch-8tlroGx1.js";const u=document.querySelector(".createuser");u.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt luodaan käyttäjä");const t="http://127.0.0.1:3000/api/users",o=document.querySelector(".create_user_form"),r={username:o.querySelector("input[name=username]").value,password:o.querySelector("input[name=password]").value,email:o.querySelector("input[name=email]").value},e={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)};a(t,e).then(c=>{console.log(c),alert("Luodaan uusi käyttäjä")})});const i=document.querySelector(".loginuser");i.addEventListener("click",async n=>{n.preventDefault(),console.log("Nyt logataan sisään");const t="http://localhost:3000/api/auth/login",o=document.querySelector(".login_form"),s={username:o.querySelector("input[name=username]").value,password:o.querySelector("input[name=password]").value},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};a(t,r).then(e=>{console.log(e),console.log(e.token),localStorage.setItem("token",e.token),e.token==null?alert("Unauthorized user: käyttäjänimi tai salasana vihreellinen"):(alert(e.message),localStorage.setItem("name",e.user.username),localStorage.setItem("user_id",e.user.user_id),window.location.href="diary.html"),l("loginResponse",`localStorage set with token value: ${e.token}`)})});const m=document.querySelector("#meRequest");m.addEventListener("click",async()=>{console.log("Testataan TOKENIA ja haetaan käyttäjän tiedot");const n="http://localhost:3000/api/auth/me",t=localStorage.getItem("token");console.log("Tämä on haettu LocalStoragesta",t);const o={method:"GET",headers:{Authorization:"Bearer: "+t}};console.log(o),a(n,o).then(s=>{console.log(s),l("meResponse",`Authorized user info: ${JSON.stringify(s)}`)})});const d=document.querySelector("#clearButton");d.addEventListener("click",g);function l(n,t){document.getElementById(n).innerText=t}function g(){localStorage.removeItem("token"),l("clearResponse","localStorage cleared!")}
